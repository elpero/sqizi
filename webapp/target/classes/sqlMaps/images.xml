<!DOCTYPE sqlMap
	PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap  >



    <insert id="insertArticleImage" parameterClass="no.sqizi.webapp.domain.ArticleImage">

       insert into image (
                data,
                <isNotNull property="description">description,</isNotNull>
                name,
                type)
        values(
                #imageBytes#,
                <isNotNull property="description">#description#,</isNotNull>
                #name#,
                #type#)
       <selectKey resultClass="java.lang.Long" keyProperty="id">
            SELECT last_value FROM image_id_seq
        </selectKey>
    </insert>

    <insert id="addArticleReferenceToImage" parameterClass="no.sqizi.webapp.domain.ArticleImage">
        INSERT INTO  article_image(article, image) values (#articleId#, #id#)
    </insert>


</sqlMap>